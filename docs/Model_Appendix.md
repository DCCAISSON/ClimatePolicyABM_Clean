# å¤šæ™ºèƒ½ä½“æ°”å€™æ”¿ç­–æ¨¡å‹ - ç†è®ºé™„å½•ä¸æŠ€æœ¯è§„èŒƒ

## ğŸ“‹ ç›®å½•
- [æ¨¡å‹ç®€åŒ–è®¾è®¡ç†å¿µ](#æ¨¡å‹ç®€åŒ–è®¾è®¡ç†å¿µ)
- [ä¼ä¸šå¼‚è´¨æ€§çš„ç»æµå­¦åŸºç¡€](#ä¼ä¸šå¼‚è´¨æ€§çš„ç»æµå­¦åŸºç¡€)
- [å¸‚åœºæœºåˆ¶ç†è®ºåŸºç¡€](#å¸‚åœºæœºåˆ¶ç†è®ºåŸºç¡€)
- [é¢„æœŸå½¢æˆç†è®º](#é¢„æœŸå½¢æˆç†è®º)
- [æŠ€æœ¯è§„èŒƒ](#æŠ€æœ¯è§„èŒƒ)
- [å‚æ•°æ ‡å®š](#å‚æ•°æ ‡å®š)
- [éªŒè¯æ–¹æ³•](#éªŒè¯æ–¹æ³•)

---

## ğŸ¯ æ¨¡å‹ç®€åŒ–è®¾è®¡ç†å¿µ

### ç»æµå­¦ç†è®ºåŸºç¡€

æ ¹æ®ç°ä»£ä¼ä¸šç†è®ºå’Œäº§ä¸šç»„ç»‡ç†è®ºï¼Œæœ¬æ¨¡å‹é‡‡ç”¨ä»¥ä¸‹æ ¸å¿ƒè®¾å®šï¼š

#### **ä¼ä¸šç”Ÿäº§ä¸å¼‚è´¨æ€§çš„ç†è®ºæ¡†æ¶**

æ¯ä¸ªä¼ä¸š $i$ï¼ˆ$i = 1, 2, ..., I = \sum_s I_s$ï¼‰ç”Ÿäº§ä¸€ç§ä¸»è¦äº§å“ $g$ï¼ˆ$g = 1, 2, ..., G$ï¼‰ï¼Œä½¿ç”¨åŠ³åŠ¨åŠ›ã€èµ„æœ¬å’Œæ¥è‡ªå…¶ä»–ä¼ä¸šçš„ä¸­é—´æŠ•å…¥ã€‚ä¼ä¸š $i$ éš¶å±äºæŸä¸ªäº§ä¸šæˆ–éƒ¨é—¨ $s$ï¼ˆ$s = 1, 2, ..., S$ï¼‰ï¼Œæ¯ä¸ªäº§ä¸šæœ‰ $I_s$ ä¸ªä¼ä¸šã€‚

**æ ¸å¿ƒç»æµå­¦åŸç†**ï¼š
1. **äº§å“å¼‚è´¨æ€§**ï¼šåŒç±»å‹ä¼ä¸šåªç”Ÿäº§ä¸€ç§äº§å“ï¼Œä½†æ¯ä¸ªä¼ä¸šç”Ÿäº§çš„è¿™ç§äº§å“å…·æœ‰å¼‚è´¨æ€§
2. **ä¸ç¡®å®šæ€§ç¯å¢ƒ**ï¼šä¼ä¸šé¢ä¸´æœªæ¥é”€å”®é¢ã€å¸‚åœºä»·æ ¼ã€æŠ•å…¥å¯å¾—æ€§ã€å·¥èµ„ã€ç°é‡‘æµç­‰æ ¹æœ¬ä¸ç¡®å®šæ€§
3. **é¢„æœŸå½¢æˆ**ï¼šæ¯ä¸ªä¼ä¸šå¿…é¡»å¯¹æœªæ¥å½¢æˆé¢„æœŸï¼Œè€Œè¿™äº›é¢„æœŸå¯èƒ½ä¸å®é™…æƒ…å†µä¸ç¬¦
4. **å¼‚è´¨æ€§æ¥æº**ï¼šæŠ€æœ¯æ°´å¹³ã€è´¨é‡æŠ•èµ„ã€ç ”å‘æŠ•èµ„ã€å£°èª‰ç­‰å¯è§‚æµ‹ã€å¯é‡åŒ–çš„æŒ‡æ ‡

### ä¼ä¸šåˆ†ç±»çš„ç»æµå­¦é€»è¾‘

åŸºäºå†œä¸šä»·å€¼é“¾å’Œäº§ä¸šå…³è”ç†è®ºï¼Œæœ¬æ¨¡å‹è®¾å®š**å…­å¤§ç±»ä¼ä¸š**ï¼š

#### **1. ä¸Šæ¸¸å·¥ä¸šä¼ä¸šï¼ˆ3ç±»ï¼‰**
ä¸ºå†œä¸šç”Ÿäº§æä¾›ç°ä»£åŒ–æŠ•å…¥å“ï¼Œä½“ç°å†œä¸šå·¥ä¸šåŒ–ï¼š

- **å†œè¯ä¼ä¸š**ï¼šæ¤ç‰©ä¿æŠ¤äº§å“ä¾›åº”å•†
- **åŒ–è‚¥ä¼ä¸š**ï¼šåœŸå£¤è¥å…»æŠ•å…¥å“ä¾›åº”å•†  
- **åŠ å·¥ä¼ä¸š**ï¼šå†œäº§å“å¢å€¼åŠ å·¥å•†

#### **2. å†œä¸šç”Ÿäº§ä¼ä¸šï¼ˆ3ç±»ï¼‰**
**ä¸¥æ ¼é™å®šä¸ºä¸‰ç±»**ï¼Œä½“ç°ç§æ¤ä¸šçš„åŸºæœ¬åˆ†åŒ–ï¼š

- **ç²®é£Ÿä½œç‰©ç”Ÿäº§ä¼ä¸š**ï¼šä¸“ä¸šåŒ–ç”Ÿäº§ç²®é£Ÿä½œç‰©
- **ç»æµä½œç‰©ç”Ÿäº§ä¼ä¸š**ï¼šä¸“ä¸šåŒ–ç”Ÿäº§ç»æµä½œç‰©
- **æ··åˆä½œç‰©ç”Ÿäº§ä¼ä¸š**ï¼šå¤šå…ƒåŒ–ç”Ÿäº§ç­–ç•¥

**é‡è¦è¯´æ˜**ï¼š**ä¸è€ƒè™‘ç•œç‰§ä¸š**ç­‰å…¶ä»–å†œä¸šå½¢å¼ï¼Œèšç„¦ç§æ¤ä¸šã€‚

#### **3. æŠ€æœ¯æœåŠ¡ä¼ä¸šï¼ˆ1ç±»ï¼‰**
è¿æ¥ä¸Šä¸‹æ¸¸ï¼Œæä¾›æŠ€æœ¯æ”¯æ’‘ï¼š

- **å†œä¸šæœåŠ¡ä¼ä¸š**ï¼šå†œæœºæœåŠ¡ã€æŠ€æœ¯å’¨è¯¢ã€æ¤ä¿æœåŠ¡

---

## ğŸ§¬ ä¼ä¸šå¼‚è´¨æ€§çš„ç»æµå­¦åŸºç¡€

### 1. ç†è®ºæ¡†æ¶

#### 1.1 å¼‚è´¨æ€§ä¼ä¸šç†è®ºï¼ˆMelitz 2003æ‰©å±•ï¼‰

ä¼ä¸šå¼‚è´¨æ€§ä¸å†æ˜¯å¤–ç”Ÿç»™å®šï¼Œè€Œæ˜¯å†…ç”Ÿäºä¼ä¸šæŠ•èµ„å’Œå­¦ä¹ è¿‡ç¨‹ï¼š

```
ä¼ä¸šiçš„å¼‚è´¨æ€§å‘é‡ï¼š
Î˜áµ¢ = [Aáµ¢, Qáµ¢, Ráµ¢, Repáµ¢]

å…¶ä¸­ï¼š
Aáµ¢: æŠ€æœ¯æ°´å¹³ï¼ˆç”Ÿäº§ç‡ï¼‰
Qáµ¢: è´¨é‡æŠ•èµ„æ°´å¹³  
Ráµ¢: ç ”å‘æŠ•èµ„å¼ºåº¦
Repáµ¢: å¸‚åœºå£°èª‰
```

#### 1.2 æŠ€æœ¯æ°´å¹³æ¼”åŒ–æ–¹ç¨‹

åŸºäºå†…ç”Ÿå¢é•¿ç†è®ºï¼ˆRomer 1990ï¼‰ï¼ŒæŠ€æœ¯æ°´å¹³çš„æ¼”åŒ–ï¼š

```
Aáµ¢,â‚œâ‚Šâ‚ = Aáµ¢,â‚œ Ã— (1 + Î´) Ã— (1 + Î»áµ£Ã—Ráµ¢,â‚œ) Ã— (1 + Î»â‚›Ã—Spilloveráµ¢,â‚œ)

å…¶ä¸­ï¼š
Î´ = 0.015: å¤–ç”ŸæŠ€æœ¯è¿›æ­¥ç‡ï¼ˆå¹´1.5%ï¼‰
Î»áµ£ = 0.12: R&Då¯¹æŠ€æœ¯è¿›æ­¥çš„å¼¹æ€§
Î»â‚› = 0.08: æŠ€æœ¯æº¢å‡ºå¼¹æ€§

æŠ€æœ¯æº¢å‡ºå‡½æ•°ï¼š
Spilloveráµ¢,â‚œ = Î£â±¼ Ï‰áµ¢â±¼ Ã— max(0, Aâ±¼,â‚œ - Aáµ¢,â‚œ) Ã— AbsorptiveCapacityáµ¢

å…¶ä¸­ï¼š
Ï‰áµ¢â±¼ = exp(-dáµ¢â±¼/30) Ã— industry_relatednessáµ¢â±¼ Ã— network_strengtháµ¢â±¼
AbsorptiveCapacityáµ¢ = min(1, Ráµ¢,â‚œâ‚‹â‚ / (0.03 Ã— Revenueáµ¢,â‚œâ‚‹â‚))
```

#### 1.3 äº§å“è´¨é‡ç”Ÿäº§å‡½æ•°

åŸºäºLancasterï¼ˆ1966ï¼‰ç‰¹å¾äº§å“ç†è®ºå’ŒSuttonï¼ˆ1991ï¼‰è´¨é‡æŠ•èµ„ç†è®ºï¼š

```
è´¨é‡ç”Ÿäº§å‡½æ•°ï¼ˆCESå½¢å¼ï¼‰ï¼š
Qáµ¢,â‚œ = Aq Ã— [Î±â‚œÃ—Aáµ¢,â‚œáµ– + Î±qÃ—QCapitaláµ¢,â‚œáµ– + Î±áµ£Ã—RDStockáµ¢,â‚œáµ– + Î±áµ£â‚‘â‚šÃ—Repáµ¢,â‚œáµ–]^(1/Ï)

å‚æ•°æ ‡å®šï¼ˆåŸºäºä¸­å›½åˆ¶é€ ä¸šè°ƒç ”ï¼‰ï¼š
Aq = 1.2: è´¨é‡å…¨è¦ç´ ç”Ÿäº§ç‡
Î±â‚œ = 0.35: æŠ€æœ¯æ°´å¹³è´¡çŒ®ä»½é¢
Î±q = 0.30: è´¨é‡èµ„æœ¬è´¡çŒ®ä»½é¢  
Î±áµ£ = 0.25: ç ”å‘å­˜é‡è´¡çŒ®ä»½é¢
Î±áµ£â‚‘â‚š = 0.10: å£°èª‰è´¡çŒ®ä»½é¢
Ï = -0.4: æ›¿ä»£å¼¹æ€§å‚æ•°ï¼ˆå¯¹åº”Ïƒ=1.67ï¼‰

è´¨é‡èµ„æœ¬ç§¯ç´¯ï¼š
QCapitaláµ¢,â‚œâ‚Šâ‚ = (1-Î´q) Ã— QCapitaláµ¢,â‚œ + QInvestmentáµ¢,â‚œ
Î´q = 0.25: è´¨é‡èµ„æœ¬æŠ˜æ—§ç‡

ç ”å‘å­˜é‡ç§¯ç´¯ï¼š
RDStockáµ¢,â‚œâ‚Šâ‚ = (1-Î´áµ£) Ã— RDStockáµ¢,â‚œ + RDInvestmentáµ¢,â‚œ  
Î´áµ£ = 0.20: ç ”å‘å­˜é‡æŠ˜æ—§ç‡
```

#### 1.4 å£°èª‰åŠ¨æ€æ¼”åŒ–æ¨¡å‹

åŸºäºä¿¡å·ä¼ é€’ç†è®ºï¼ˆSpence 1973ï¼‰å’Œå£°èª‰ç†è®ºï¼ˆMilgrom & Roberts 1986ï¼‰ï¼š

```
å£°èª‰æ¼”åŒ–æ–¹ç¨‹ï¼ˆAR(1) + å¸‚åœºåé¦ˆï¼‰ï¼š
Repáµ¢,â‚œâ‚Šâ‚ = Î±áµ£â‚‘â‚š Ã— Repáµ¢,â‚œ + (1-Î±áµ£â‚‘â‚š) Ã— TargetRepáµ¢,â‚œ + Îµáµ¢,â‚œ

å…¶ä¸­ï¼š
Î±áµ£â‚‘â‚š = 0.8: å£°èª‰æƒ¯æ€§ç³»æ•°
Îµáµ¢,â‚œ ~ N(0, ÏƒÎµÂ²): éšæœºå£°èª‰å†²å‡»

ç›®æ ‡å£°èª‰å‡½æ•°ï¼ˆåŸºäºå¸‚åœºè¡¨ç°ï¼‰ï¼š
TargetRepáµ¢,â‚œ = wqÃ—QualityRepáµ¢,â‚œ + wpÃ—PriceRepáµ¢,â‚œ + wsÃ—ServiceRepáµ¢,â‚œ + wáµ£Ã—ReliabilityRepáµ¢,â‚œ

æƒé‡æ ‡å®šï¼ˆåŸºäºæ¶ˆè´¹è€…è¡Œä¸ºç ”ç©¶ï¼‰ï¼š
wq = 0.45: è´¨é‡å£°èª‰æƒé‡
wp = 0.25: ä»·æ ¼å£°èª‰æƒé‡
ws = 0.15: æœåŠ¡å£°èª‰æƒé‡
wáµ£ = 0.15: å¯é æ€§å£°èª‰æƒé‡

è´¨é‡å£°èª‰æ›´æ–°ï¼š
QualityRepáµ¢,â‚œ = Î²Ã—QualityRepáµ¢,â‚œâ‚‹â‚ + (1-Î²)Ã—CustomerSatisfactionáµ¢,â‚œ
Î² = 0.7: å£°èª‰æ›´æ–°å¹³æ»‘å‚æ•°

å®¢æˆ·æ»¡æ„åº¦ï¼š
CustomerSatisfactionáµ¢,â‚œ = Î£â±¼âˆˆCustomers(i) transaction_weightáµ¢â±¼ Ã— satisfactionáµ¢â±¼,â‚œ

satisfactionáµ¢â±¼,â‚œ = max(0, 1 - |DeliveredQualityáµ¢,â‚œ - ExpectedQualityâ±¼,â‚œ| / ExpectedQualityâ±¼,â‚œ)
```

### 2. å¼‚è´¨æ€§å¯¹ä¼ä¸šè¡Œä¸ºçš„å½±å“

#### 2.1 ç”Ÿäº§å†³ç­–

ä¼ä¸šiçš„ç”Ÿäº§å‡½æ•°ï¼ˆCobb-Douglaså½¢å¼ï¼‰ï¼š

```
Yáµ¢ = Aáµ¢ Ã— Káµ¢áµ… Ã— Láµ¢áµ Ã— Qáµ¢áµ

å…¶ä¸­ï¼š
Yáµ¢: ä¼ä¸šiçš„äº§å‡º
Aáµ¢: å…¨è¦ç´ ç”Ÿäº§ç‡ï¼ˆæŠ€æœ¯æ°´å¹³ï¼‰âˆˆ [0.3, 1.0]
Káµ¢: èµ„æœ¬å­˜é‡ âˆˆ [10000, 500000]
Láµ¢: åŠ³åŠ¨æŠ•å…¥ âˆˆ [5, 200]
Qáµ¢: è´¨é‡èµ„æœ¬ âˆˆ [0.3, 1.0]
Î± = 0.4: èµ„æœ¬äº§å‡ºå¼¹æ€§
Î² = 0.35: åŠ³åŠ¨äº§å‡ºå¼¹æ€§
Î³ = 0.25: è´¨é‡äº§å‡ºå¼¹æ€§
```

#### 2.2 å®šä»·ç­–ç•¥

å¤šç»´å¼‚è´¨æ€§å®šä»·æ¨¡å‹ï¼š

```
Páµ¢,â‚œ = MCáµ¢,â‚œ Ã— (1 + MarkUpáµ¢,â‚œ) Ã— QualityPremiumáµ¢,â‚œ Ã— 
        ReputationPremiumáµ¢,â‚œ Ã— CompetitionFactoráµ¢,â‚œ

åŠ æˆç‡å†…ç”ŸåŒ–ï¼ˆåŸºäºå¸‚åœºåŠ›é‡ï¼‰ï¼š
MarkUpáµ¢,â‚œ = Î¼base / (1 + Ïƒ Ã— MarketShareáµ¢,â‚œâ»áµ)

å…¶ä¸­ï¼š
Î¼base = 0.25: åŸºç¡€åŠ æˆç‡
Ïƒ = 3.5: ç«äº‰å¼ºåº¦å‚æ•°
Î³ = 0.8: å¸‚åœºä»½é¢å¼¹æ€§

è´¨é‡æº¢ä»·å‡½æ•°ï¼ˆéçº¿æ€§ï¼‰ï¼š
QualityPremiumáµ¢,â‚œ = 1 + Îºâ‚Ã—(Qáµ¢,â‚œ - QÌ„â‚œ) + Îºâ‚‚Ã—(Qáµ¢,â‚œ - QÌ„â‚œ)Â²

å…¶ä¸­ï¼š
Îºâ‚ = 0.35: ä¸€é˜¶è´¨é‡æº¢ä»·å¼¹æ€§
Îºâ‚‚ = 0.08: äºŒé˜¶è´¨é‡æº¢ä»·å¼¹æ€§ï¼ˆæ”¶ç›Šé€’å‡ï¼‰
QÌ„â‚œ: å¸‚åœºå¹³å‡è´¨é‡

å£°èª‰æº¢ä»·å‡½æ•°ï¼š
ReputationPremiumáµ¢,â‚œ = 1 + Î·Ã—(Repáµ¢,â‚œ - 0.5)Ã—CustomerLoyaltyáµ¢,â‚œ

å…¶ä¸­ï¼š
Î· = 0.15: å£°èª‰æº¢ä»·å¼¹æ€§
CustomerLoyaltyáµ¢,â‚œ = MarketShareáµ¢,â‚œâ‚‹â‚ Ã— RepeatPurchaseRateáµ¢,â‚œ

ç«äº‰è°ƒæ•´å› å­ï¼š
CompetitionFactoráµ¢,â‚œ = 1 - Ï†Ã—(Páµ¢,â‚œâ‚‹â‚ - AvgCompetitorPriceáµ¢,â‚œâ‚‹â‚)/AvgCompetitorPriceáµ¢,â‚œâ‚‹â‚

Ï† = 0.2: ä»·æ ¼ç«äº‰æ•æ„Ÿåº¦
```

#### 2.3 æŠ•èµ„å†³ç­–

ä¼ä¸šæŠ•èµ„çš„å¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜ï¼š

```
max Î£â‚›â‚Œâ‚œ^âˆ Î´Ë¢â»áµ— Ã— [Revenueáµ¢,â‚›(Qáµ¢,â‚›) - Costáµ¢,â‚› - InvestmentCostáµ¢,â‚›]

s.t. 
Qáµ¢,â‚›â‚Šâ‚ = f(Aáµ¢,â‚›, QInváµ¢,â‚›, RDáµ¢,â‚›, Repáµ¢,â‚›)
QInváµ¢,â‚œ âˆˆ [0, max_quality_investment_rate Ã— Revenueáµ¢,â‚œ]
RDáµ¢,â‚œ âˆˆ [0, max_rd_investment_rate Ã— Revenueáµ¢,â‚œ]

è´¨é‡æŠ•èµ„æˆæœ¬å‡½æ•°ï¼ˆè€ƒè™‘è°ƒæ•´æˆæœ¬ï¼‰ï¼š
QualityInvestmentCostáµ¢,â‚œ = clinearÃ—QInváµ¢,â‚œ + cquadraticÃ—(QInváµ¢,â‚œ)Â² + 
                           cadjustmentÃ—(QInváµ¢,â‚œ - QInváµ¢,â‚œâ‚‹â‚)Â²

å…¶ä¸­ï¼š
clinear = 1.0: çº¿æ€§æˆæœ¬ç³»æ•°
cquadratic = 2.5: äºŒæ¬¡æˆæœ¬ç³»æ•°ï¼ˆè¾¹é™…æˆæœ¬é€’å¢ï¼‰
cadjustment = 1.8: è°ƒæ•´æˆæœ¬ç³»æ•°ï¼ˆæŠ•èµ„å¹³æ»‘åŒ–æ¿€åŠ±ï¼‰
```

---

## ğŸª å¸‚åœºæœºåˆ¶ç†è®ºåŸºç¡€

### 1. æœå¯»åŒ¹é…ç†è®º

åŸºäºDiamondï¼ˆ1982ï¼‰å’ŒLagos & Wrightï¼ˆ2005ï¼‰çš„æœå¯»åŒ¹é…ç†è®ºï¼š

#### 1.1 åŒè¾¹æœå¯»åŒ¹é…æœºåˆ¶

å¸‚åœºä¸å†æ˜¯ç®€å•çš„ä»·æ ¼æ’®åˆï¼Œè€Œæ˜¯åŸºäºè´¨é‡åå¥½çš„åŒè¾¹æœå¯»è¿‡ç¨‹ï¼š

```
ä¹°æ–¹æœå¯»ä»·å€¼å‡½æ•°ï¼ˆBellmanæ–¹ç¨‹ï¼‰ï¼š
V^B(qpref, budget) = max{Î± Ã— maxâ‚›[U(qpref, s) - csearch], Î´ Ã— V^B(qpref, budget)}

å…¶ä¸­ï¼š
Î±: æœå¯»æˆåŠŸæ¦‚ç‡ âˆˆ [0.6, 0.9]
Î´ = 0.95: æ—¶é—´è´´ç°å› å­
csearch: å•æ¬¡æœå¯»æˆæœ¬ âˆˆ [10, 100]
s: ä¾›åº”å•†ç‰¹å¾å‘é‡ [quality, price, reputation]

åŒ¹é…æ•ˆç”¨å‡½æ•°ï¼ˆå¤šå±æ€§å†³ç­–æ¨¡å‹ï¼‰ï¼š
U(buyer, supplier) = Î£â‚– wâ‚– Ã— uâ‚–(buyer, supplier)

æ•ˆç”¨åˆ†è§£ï¼š
uquality = 1 - |supplier.quality - buyer.quality_preference|
uprice = max(0, 1 - (supplier.price/buyer.budget) Ã— buyer.price_sensitivity)
ureputation = supplier.reputation
ureliability = supplier.delivery_reliability
uservice = supplier.after_sales_rating

æƒé‡è®¾å®šï¼ˆåŸºäºæ¶ˆè´¹è€…é€‰æ‹©å®è¯ç ”ç©¶ï¼‰ï¼š
wquality = 0.45 + 0.15Ã—buyer.income_level + 0.1Ã—buyer.education
wprice = 0.35 - 0.1Ã—buyer.income_level + 0.05Ã—buyer.risk_aversion
wreputation = 0.15 + 0.05Ã—buyer.experience
wreliability = 0.03
wservice = 0.02
```

#### 1.2 æœå¯»æˆæœ¬å»ºæ¨¡

```
æœå¯»æˆæœ¬å‡½æ•°ï¼ˆè€ƒè™‘ä¿¡æ¯ä¸å¯¹ç§°å’Œè·ç¦»ï¼‰ï¼š
SearchCostáµ¢â±¼ = cbase + cdistanceÃ—dáµ¢â±¼ + cinfoÃ—InfoAsymmetryáµ¢â±¼

å…¶ä¸­ï¼š
cbase = 20: åŸºç¡€æœå¯»æˆæœ¬
cdistance = 0.5: è·ç¦»æˆæœ¬ç³»æ•°
cinfo = 15: ä¿¡æ¯ä¸å¯¹ç§°æˆæœ¬
dáµ¢â±¼: ä¹°æ–¹iå’Œå–æ–¹jçš„è·ç¦»
InfoAsymmetryáµ¢â±¼ = 1 - HistoricalInteractionáµ¢â±¼

æœ€ä¼˜æœå¯»ç­–ç•¥ï¼ˆä¿ç•™ä»·å€¼æ–¹æ³•ï¼‰ï¼š
ReservationUtilityáµ¢ = E[Uáµ¢,best] - ExpectedSearchCostáµ¢

Accept if: U(i,j) â‰¥ ReservationUtilityáµ¢
```

### 2. å¸‚åœºå‡ºæ¸…æœºåˆ¶

#### 2.1 è´¨é‡åˆ†å±‚å¸‚åœº

åŸºäºTiroleï¼ˆ1988ï¼‰è´¨é‡åˆ†å±‚ç†è®ºï¼š

```
å¸‚åœºåˆ†ä¸ºKä¸ªè´¨é‡å±‚æ¬¡ï¼š
Market = {Mâ‚, Mâ‚‚, ..., Mâ‚–}

è´¨é‡è¾¹ç•Œï¼š
qâ‚ < qâ‚‚ < ... < qâ‚–

æ¶ˆè´¹è€…è´¨é‡åå¥½åˆ†å¸ƒï¼š
qpref ~ F(qpref | income, education, risk_preference)

å¸‚åœºkçš„éœ€æ±‚å‡½æ•°ï¼š
Dâ‚–(pâ‚–, qâ‚–) = âˆ«[æ¶ˆè´¹è€…é€‰æ‹©å¸‚åœºk] f(Î¸)dÎ¸

å…¶ä¸­Î¸ = [income, education, risk_preference]ä¸ºæ¶ˆè´¹è€…ç‰¹å¾å‘é‡
```

#### 2.2 ä»·æ ¼å‘ç°æœºåˆ¶

```
å¸‚åœºkçš„å‡è¡¡æ¡ä»¶ï¼š
Dâ‚–(pâ‚–, qâ‚–) = Sâ‚–(pâ‚–, qâ‚–)

ä¾›ç»™å‡½æ•°ï¼š
Sâ‚–(pâ‚–, qâ‚–) = Î£áµ¢âˆˆEnterprisesâ‚– Yáµ¢(pâ‚–, qâ‚–)

ä»·æ ¼è°ƒæ•´è¿‡ç¨‹ï¼ˆtÃ¢tonnementè¿‡ç¨‹ï¼‰ï¼š
dpâ‚–/dt = Î» Ã— [Dâ‚–(pâ‚–, qâ‚–) - Sâ‚–(pâ‚–, qâ‚–)]

å…¶ä¸­Î» > 0ä¸ºä»·æ ¼è°ƒæ•´é€Ÿåº¦å‚æ•°
```

---

## ğŸ§  é¢„æœŸå½¢æˆç†è®º

### 1. AR(1)è‡ªé€‚åº”å­¦ä¹ æœºåˆ¶

åŸºäºé€‚åº”æ€§é¢„æœŸç†è®ºï¼ˆNerlove 1958ï¼‰å’Œæœ‰ç•Œç†æ€§ç†è®ºï¼ˆSimon 1955ï¼‰ï¼š

#### 1.1 é¢„æœŸå½¢æˆè¿‡ç¨‹

```
AR(1)é¢„æœŸå½¢æˆæ–¹ç¨‹ï¼š
Eâ‚œ[Xâ‚œâ‚Šâ‚•] = Î± + Î²Ã—Xâ‚œ + Î³Ã—trendâ‚œ + Îµâ‚œ

å…¶ä¸­ï¼š
Î±, Î², Î³: é€šè¿‡é€’å½’æœ€å°äºŒä¹˜æ³•ï¼ˆRLSï¼‰åœ¨çº¿å­¦ä¹ çš„å‚æ•°
h: é¢„æµ‹æœŸæ•°
trendâ‚œ: è¶‹åŠ¿é¡¹
Îµâ‚œ: é¢„æµ‹è¯¯å·®

é€’å½’æœ€å°äºŒä¹˜æ³•æ›´æ–°ï¼š
Î¸â‚œâ‚Šâ‚ = Î¸â‚œ + Kâ‚œâ‚Šâ‚ Ã— (Xâ‚œâ‚Šâ‚ - XÌ‚â‚œâ‚Šâ‚)
Kâ‚œâ‚Šâ‚ = Pâ‚œÃ—zâ‚œâ‚Šâ‚ / (Î» + zâ‚œâ‚Šâ‚áµ€Ã—Pâ‚œÃ—zâ‚œâ‚Šâ‚)
Pâ‚œâ‚Šâ‚ = (1/Î») Ã— [Pâ‚œ - Kâ‚œâ‚Šâ‚Ã—zâ‚œâ‚Šâ‚áµ€Ã—Pâ‚œ]

å…¶ä¸­ï¼š
Î¸â‚œ = [Î±, Î², Î³]áµ€: å‚æ•°å‘é‡
zâ‚œâ‚Šâ‚ = [1, Xâ‚œ, trendâ‚œ]áµ€: å›å½’å‘é‡
Î» âˆˆ [0.95, 0.99]: é—å¿˜å› å­
```

#### 1.2 ç½®ä¿¡åº¦è°ƒæ•´æœºåˆ¶

```
é¢„æœŸç½®ä¿¡åº¦è®¡ç®—ï¼š
Confidenceâ‚œ = exp(-Î»c Ã— RMSEâ‚œ)

å…¶ä¸­ï¼š
Î»c: ç½®ä¿¡åº¦è¡°å‡ç³»æ•°
RMSEâ‚œ: æ»šåŠ¨é¢„æµ‹å‡æ–¹æ ¹è¯¯å·®

RMSEâ‚œ = âˆš(1/T Ã— Î£â‚›â‚Œâ‚œâ‚‹â‚œâ‚Šâ‚áµ— (Xâ‚› - Eâ‚›â‚‹â‚•[Xâ‚›])Â²)

é£é™©è°ƒæ•´é¢„æœŸï¼š
AdjustedExpectationâ‚œ = Eâ‚œ[Xâ‚œâ‚Šâ‚•] + RiskAdjustmentâ‚œ

é£é™©è°ƒæ•´é¡¹ï¼š
RiskAdjustmentâ‚œ = risk_attitudeáµ¢ Ã— (Confidenceâ‚œ - 0.5) Ã— Ïƒâ‚œ

å…¶ä¸­ï¼š
risk_attitudeáµ¢ âˆˆ [-1, 1]: é£é™©æ€åº¦ï¼ˆ-1æåº¦é£é™©åŒæ¶ï¼Œ+1æåº¦é£é™©åå¥½ï¼‰
Ïƒâ‚œ: é¢„æµ‹ä¸ç¡®å®šæ€§ï¼ˆé¢„æµ‹åŒºé—´å®½åº¦ï¼‰
```

### 2. å¤šå˜é‡é¢„æœŸç³»ç»Ÿ

#### 2.1 é¢„æœŸå˜é‡åˆ†ç±»

**æŒ‰æ™ºèƒ½ä½“ç±»å‹åˆ†ç±»çš„é¢„æœŸå˜é‡ï¼š**

```
å†œè¯ä¼ä¸šé¢„æœŸå˜é‡ï¼š
expectation_variables = {
    'farmer_demand',           % å†œæˆ·éœ€æ±‚
    'input_material_cost',     % åŸææ–™æˆæœ¬
    'competition_intensity',   % ç«äº‰å¼ºåº¦
    'regulation_stringency',   % ç›‘ç®¡ä¸¥æ ¼ç¨‹åº¦
    'environmental_tax_rate',  % ç¯å¢ƒç¨ç‡
    'pest_outbreak_prob'       % ç—…è™«å®³çˆ†å‘æ¦‚ç‡
}

åŒ–è‚¥ä¼ä¸šé¢„æœŸå˜é‡ï¼š
expectation_variables = {
    'crop_planting_area',           % ä½œç‰©ç§æ¤é¢ç§¯
    'organic_fertilizer_trend',     % æœ‰æœºè‚¥è¶‹åŠ¿
    'precision_agriculture_adoption', % ç²¾å‡†å†œä¸šé‡‡ç”¨ç‡
    'nitrogen_price_volatility'     % æ°®è‚¥ä»·æ ¼æ³¢åŠ¨ç‡
}

å†œä¸šæœåŠ¡ä¼ä¸šé¢„æœŸå˜é‡ï¼š
expectation_variables = {
    'service_demand',          % æœåŠ¡éœ€æ±‚
    'agricultural_income',     % å†œä¸šæ”¶å…¥æ°´å¹³
    'modernization_rate',      % å†œä¸šç°ä»£åŒ–é€Ÿåº¦
    'technology_trend',        % æŠ€æœ¯å‘å±•è¶‹åŠ¿
    'fuel_price'              % ç‡ƒæ²¹ä»·æ ¼
}
```

#### 2.2 é¢„æœŸå˜é‡è¾¹ç•Œè®¾å®š

```
å˜é‡è¾¹ç•Œè®¾å®šï¼ˆåŸºäºä¸­å›½å†œä¸šæ•°æ®ï¼‰ï¼š
bounds = struct(
    'farmer_demand', [1000, 20000],           % å†œæˆ·éœ€æ±‚ï¼ˆå¨ï¼‰
    'input_material_cost', [500, 1500],       % åŸææ–™æˆæœ¬ï¼ˆå…ƒ/å¨ï¼‰
    'competition_intensity', [0.2, 0.9],      % ç«äº‰å¼ºåº¦
    'environmental_tax_rate', [0, 0.3],       % ç¯å¢ƒç¨ç‡
    'agricultural_income', [20000, 100000],   % å†œä¸šæ”¶å…¥ï¼ˆå…ƒï¼‰
    'modernization_rate', [0.02, 0.15],      % ç°ä»£åŒ–é€Ÿåº¦
    'fuel_price', [5.0, 12.0]                % ç‡ƒæ²¹ä»·æ ¼ï¼ˆå…ƒ/å‡ï¼‰
);
```

---

## âš™ï¸ æŠ€æœ¯è§„èŒƒ

### 1. è½¯ä»¶æ¶æ„

#### 1.1 æ ¸å¿ƒç±»å±‚æ¬¡ç»“æ„

```
æ™ºèƒ½ä½“ç»§æ‰¿å±‚æ¬¡ï¼š
AgentWithExpectations (æŠ½è±¡åŸºç±»)
â”œâ”€â”€ EnterpriseAgentWithExpectations (ä¼ä¸šåŸºç±»)
â”‚   â”œâ”€â”€ PesticideEnterpriseAgent
â”‚   â”œâ”€â”€ FertilizerEnterpriseAgent
â”‚   â”œâ”€â”€ AgroProcessingEnterpriseAgent
â”‚   â”œâ”€â”€ GrainFarmAgent
â”‚   â”œâ”€â”€ CashCropFarmAgent
â”‚   â”œâ”€â”€ MixedCropFarmAgent
â”‚   â””â”€â”€ AgriculturalServiceEnterpriseAgent
â”œâ”€â”€ HouseholdAgent (å†œæˆ·)
â””â”€â”€ GovernmentAgent (æ”¿åºœ)

å¸‚åœºæ¨¡å—å±‚æ¬¡ï¼š
MarketModule (åŸºç±»)
â”œâ”€â”€ PesticideMarketModule
â”œâ”€â”€ FertilizerMarketModule
â”œâ”€â”€ CommodityMarketModule
â”œâ”€â”€ LandMarketModule
â””â”€â”€ LaborMarketModule
```

#### 1.2 å…³é”®æ¥å£å®šä¹‰

```matlab
% æŠ½è±¡æ–¹æ³•å®šä¹‰
methods (Abstract)
    make_decision_with_expectations(obj, market_info, expectations)
    % åŸºäºé¢„æœŸåšå‡ºå†³ç­–
    
    identify_key_expectation_variables(obj)
    % è¯†åˆ«å…³é”®çš„é¢„æœŸå˜é‡
end

% é¢„æœŸå½¢æˆæ¥å£
methods
    update_expectations(obj, observations, current_time)
    get_expectation(obj, var_name, horizon, adjust_for_confidence)
    combine_expectation_with_current(obj, var_name, current_value, horizon)
end
```

### 2. æ•°æ®ç»“æ„è®¾è®¡

#### 2.1 ä¼ä¸šæ•°æ®ç»“æ„

```matlab
% ä¼ä¸šå¼‚è´¨æ€§æ•°æ®ç»“æ„
Enterprise_Data = struct(
    'id', [],                          % ä¼ä¸šID
    'type', '',                        % ä¼ä¸šç±»å‹
    'technology_level', [],            % æŠ€æœ¯æ°´å¹³ [0.3,1.0]
    'product_quality', [],             % äº§å“è´¨é‡ [0.3,1.0]
    'quality_investment', [],          % è´¨é‡æŠ•èµ„æ¯”ä¾‹ [0.01,0.08]
    'rd_investment', [],               % ç ”å‘æŠ•èµ„æ¯”ä¾‹ [0.005,0.06]
    'reputation', [],                  % ä¼ä¸šå£°èª‰ [0,1]
    'market_share', [],                % å¸‚åœºä»½é¢ [0,1]
    'production_capacity', [],         % ç”Ÿäº§èƒ½åŠ›
    'emission_rate', [],               % æ’æ”¾ç³»æ•°
    'expectation_module', [],          % é¢„æœŸå½¢æˆæ¨¡å—
    'decision_history', [],            % å†³ç­–å†å²
    'performance_history', []          % ç»©æ•ˆå†å²
);
```

#### 2.2 å¸‚åœºæ•°æ®ç»“æ„

```matlab
% å¸‚åœºåŒ¹é…æ•°æ®ç»“æ„
Market_Data = struct(
    'suppliers', [],                   % ä¾›åº”å•†åˆ—è¡¨
    'demanders', [],                   % éœ€æ±‚æ–¹åˆ—è¡¨
    'match_records', [],               % åŒ¹é…è®°å½•
    'transaction_prices', [],          % äº¤æ˜“ä»·æ ¼
    'transaction_volumes', [],         % äº¤æ˜“é‡
    'matching_efficiency', [],         % åŒ¹é…æ•ˆç‡
    'search_costs', [],                % æœå¯»æˆæœ¬
    'quality_premiums', [],            % è´¨é‡æº¢ä»·
    'market_concentration', []         % å¸‚åœºé›†ä¸­åº¦
);
```

### 3. ç®—æ³•å®ç°

#### 3.1 è´¨é‡åŒ¹é…ç®—æ³•

```matlab
function [matches, welfare] = quality_based_matching(suppliers, demanders, params)
    % Gale-Shapleyç¨³å®šåŒ¹é…ç®—æ³•çš„è´¨é‡åŒ¹é…ç‰ˆæœ¬
    
    % æ­¥éª¤1ï¼šè®¡ç®—æ•ˆç”¨çŸ©é˜µ
    n_suppliers = length(suppliers);
    n_demanders = length(demanders);
    utility_matrix = zeros(n_demanders, n_suppliers);
    
    for i = 1:n_demanders
        for j = 1:n_suppliers
            utility_matrix(i,j) = calculate_matching_utility(...
                demanders(i), suppliers(j), params);
        end
    end
    
    % æ­¥éª¤2ï¼šç”Ÿæˆåå¥½åˆ—è¡¨
    [supplier_prefs, demander_prefs] = generate_preference_lists(utility_matrix);
    
    % æ­¥éª¤3ï¼šæ‰§è¡Œå»¶è¿Ÿæ¥å—ç®—æ³•
    matches = deferred_acceptance_algorithm(supplier_prefs, demander_prefs);
    
    % æ­¥éª¤4ï¼šè®¡ç®—æ€»ç¦åˆ©
    welfare = calculate_total_welfare(matches, utility_matrix);
end

function utility = calculate_matching_utility(demander, supplier, params)
    % å¤šå±æ€§æ•ˆç”¨å‡½æ•°
    
    % è´¨é‡åŒ¹é…æ•ˆç”¨ï¼ˆé«˜æ–¯ç›¸ä¼¼æ€§å‡½æ•°ï¼‰
    quality_distance = abs(supplier.quality - demander.quality_preference);
    quality_utility = exp(-quality_distance^2 / (2 * params.quality_variance));
    
    % ä»·æ ¼æ•ˆç”¨ï¼ˆè´ŸæŒ‡æ•°æ•ˆç”¨ï¼‰
    normalized_price = supplier.price / demander.budget;
    price_utility = exp(-params.price_sensitivity * normalized_price);
    
    % å£°èª‰æ•ˆç”¨ï¼ˆSå‹æ•ˆç”¨å‡½æ•°ï¼‰
    reputation_utility = 1 / (1 + exp(-params.reputation_slope * (supplier.reputation - 0.5)));
    
    % è·ç¦»æˆæœ¬
    distance_cost = params.distance_cost_factor * calculate_distance(demander, supplier);
    
    % æœå¯»æˆæœ¬
    search_cost = calculate_search_cost(demander, supplier, params);
    
    % ç»¼åˆæ•ˆç”¨
    utility = params.weight_quality * quality_utility + ...
              params.weight_price * price_utility + ...
              params.weight_reputation * reputation_utility - ...
              distance_cost - search_cost;
    
    utility = max(0, utility);  % éè´Ÿçº¦æŸ
end
```

#### 3.2 é¢„æœŸå­¦ä¹ ç®—æ³•

```matlab
function update_model_parameters(obj, var_name, new_observation)
    % é€’å½’æœ€å°äºŒä¹˜æ³•å‚æ•°æ›´æ–°
    
    % è·å–å½“å‰å‚æ•°
    theta = obj.model_parameters.(var_name);
    P = obj.covariance_matrix.(var_name);
    
    % æ„å»ºå›å½’å‘é‡
    if length(obj.historical_data.(var_name)) >= 2
        x_t = obj.historical_data.(var_name)(end);
        trend_t = calculate_trend(obj.historical_data.(var_name));
        z = [1; x_t; trend_t];
    else
        z = [1; new_observation; 0];
    end
    
    % é¢„æµ‹è¯¯å·®
    prediction_error = new_observation - z' * theta;
    
    % æ›´æ–°å¢ç›ŠçŸ©é˜µ
    K = P * z / (obj.forgetting_factor + z' * P * z);
    
    % æ›´æ–°å‚æ•°
    theta = theta + K * prediction_error;
    
    % æ›´æ–°åæ–¹å·®çŸ©é˜µ
    P = (P - K * z' * P) / obj.forgetting_factor;
    
    % å­˜å‚¨æ›´æ–°åçš„å‚æ•°
    obj.model_parameters.(var_name) = theta;
    obj.covariance_matrix.(var_name) = P;
    
    % æ›´æ–°é¢„æµ‹ç²¾åº¦
    obj.update_prediction_accuracy(var_name, prediction_error);
end
```

---

## ğŸ“Š å‚æ•°æ ‡å®š

### 1. æ ‡å®šæ•°æ®æ¥æº

#### 1.1 ä¸­å›½å†œä¸šæ•°æ®æº

```
æ•°æ®æºè¯´æ˜ï¼š
1. CFPS 2010-2022ï¼šä¸­å›½å®¶åº­è¿½è¸ªè°ƒæŸ¥æ•°æ®
   - å†œæˆ·æ”¶å…¥ã€æ¶ˆè´¹ã€æŠ•èµ„è¡Œä¸º
   - æ•™è‚²æ°´å¹³ã€é£é™©åå¥½
   - æŠ€æœ¯é‡‡ç”¨å†³ç­–

2. CLES 2020-2022ï¼šä¸­å›½åŠ³åŠ¨åŠ›åŠ¨æ€è°ƒæŸ¥æ•°æ®
   - åŠ³åŠ¨åŠ›å¸‚åœºæµåŠ¨
   - å·¥èµ„æ°´å¹³ã€å°±ä¸šçŠ¶å†µ
   - æŠ€èƒ½åŸ¹è®­å‚ä¸

3. ä¸­å›½å¿åŸŸæ•°æ®åº“ï¼š
   - å†œä¸šæ€»äº§å€¼ã€ç»“æ„å˜åŒ–
   - æŠ€æœ¯æ¨å¹¿ã€æ”¿ç­–å®æ–½
   - ç¯å¢ƒæ²»ç†æ•ˆæœ

4. å…¨å›½å†œæ‘å›ºå®šè§‚å¯Ÿç‚¹ï¼ˆ1986-2017ï¼‰ï¼š
   - å†œæˆ·å¾®è§‚è¡Œä¸ºé•¿æœŸè¿½è¸ª
   - åœŸåœ°æµè½¬ã€æŠ€æœ¯é‡‡ç”¨
   - æ”¶å…¥æ¥æºç»“æ„å˜åŒ–
```

#### 1.2 æ ‡å®šç›®æ ‡è®¾å®š

```matlab
% åŸºäºå®è¯æ•°æ®çš„æ ‡å®šç›®æ ‡
calibration_targets = struct(...
    % å®è§‚æŒ‡æ ‡
    'agricultural_productivity_growth', 0.03, ...    % å¹´å‡å†œä¸šç”Ÿäº§ç‡å¢é•¿3%
    'technology_adoption_rate', 0.15, ...            % æ–°æŠ€æœ¯é‡‡ç”¨ç‡15%
    'market_concentration_hhi', 0.25, ...            % å†œä¸šæŠ•å…¥å“å¸‚åœºHHIæŒ‡æ•°
    'price_volatility_coefficient', 0.12, ...       % å†œäº§å“ä»·æ ¼å˜å¼‚ç³»æ•°12%
    
    % å¾®è§‚æŒ‡æ ‡  
    'farmer_income_growth', 0.08, ...                % å†œæˆ·æ”¶å…¥å¹´å‡å¢é•¿8%
    'land_transfer_rate', 0.05, ...                  % å¹´åœŸåœ°æµè½¬ç‡5%
    'off_farm_employment_ratio', 0.6, ...            % å†œæˆ·éå†œå°±ä¸šæ¯”ä¾‹60%
    'quality_premium_range', [0.1, 0.4], ...         % è´¨é‡æº¢ä»·10%-40%
    
    % ç¯å¢ƒæŒ‡æ ‡
    'emission_intensity_decline', 0.02, ...          % æ’æ”¾å¼ºåº¦å¹´å‡ä¸‹é™2%
    'green_technology_share', 0.3, ...               % ç»¿è‰²æŠ€æœ¯ä»½é¢30%
    'environmental_compliance_rate', 0.8 ...         % ç¯ä¿åˆè§„ç‡80%
);
```

### 2. å‚æ•°æ ‡å®šæ–¹æ³•

#### 2.1 å¤šç›®æ ‡ä¼˜åŒ–æ ¡å‡†

```matlab
% å¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜è®¾å®š
function [optimal_params, calibration_score] = multi_objective_calibration(model, targets)
    
    % å‚æ•°ç©ºé—´å®šä¹‰
    param_bounds = struct(...
        'technology_spillover_rate', [0.05, 0.15], ...
        'quality_investment_elasticity', [0.8, 1.5], ...
        'search_cost_factor', [0.01, 0.1], ...
        'learning_rate_range', [0.05, 0.2], ...
        'risk_attitude_variance', [0.1, 0.5] ...
    );
    
    % ç›®æ ‡å‡½æ•°ï¼ˆåŠ æƒè·ç¦»ï¼‰
    objective_function = @(params) calculate_calibration_distance(params, model, targets);
    
    % é—ä¼ ç®—æ³•ä¼˜åŒ–
    options = optimoptions('gamultiobj', 'Display', 'iter', 'MaxGenerations', 100);
    [optimal_params, calibration_score] = gamultiobj(objective_function, ...
        length(fieldnames(param_bounds)), [], [], [], [], ...
        lower_bounds, upper_bounds, [], options);
end

function distance = calculate_calibration_distance(params, model, targets)
    % è®¾ç½®æ¨¡å‹å‚æ•°
    model = set_model_parameters(model, params);
    
    % è¿è¡Œæ¨¡æ‹Ÿ
    results = model.run_simulation();
    
    % è®¡ç®—ç›®æ ‡è·ç¦»
    target_names = fieldnames(targets);
    distances = zeros(length(target_names), 1);
    
    for i = 1:length(target_names)
        target_name = target_names{i};
        simulated_value = extract_simulation_result(results, target_name);
        target_value = targets.(target_name);
        
        % æ ‡å‡†åŒ–è·ç¦»
        distances(i) = abs(simulated_value - target_value) / target_value;
    end
    
    % åŠ æƒå¹³å‡è·ç¦»
    weights = [0.3, 0.2, 0.2, 0.1, 0.1, 0.05, 0.05];  % æ ¹æ®é‡è¦æ€§èµ‹æƒé‡
    distance = sum(weights .* distances);
end
```

#### 2.2 æ•æ„Ÿæ€§åˆ†æ

```matlab
% Morriså…¨å±€æ•æ„Ÿæ€§åˆ†æ
function sensitivity_results = morris_sensitivity_analysis(model, param_bounds, r)
    % Morrisæ–¹æ³•å‚æ•°
    p = length(fieldnames(param_bounds));  % å‚æ•°æ•°é‡
    Delta = p / (2 * (p - 1));             % æ‰°åŠ¨æ­¥é•¿
    
    % ç”ŸæˆMorrisè½¨è¿¹
    trajectories = generate_morris_trajectories(param_bounds, r, Delta);
    
    % è®¡ç®—æ•ˆåº”
    elementary_effects = zeros(r, p);
    
    for i = 1:r
        trajectory = trajectories{i};
        for j = 1:p
            % è®¡ç®—åŸºå‡†ç‚¹å’Œæ‰°åŠ¨ç‚¹çš„æ¨¡å‹è¾“å‡º
            y_base = run_model_at_point(model, trajectory(j, :));
            y_perturbed = run_model_at_point(model, trajectory(j+1, :));
            
            % è®¡ç®—åŸºæœ¬æ•ˆåº”
            elementary_effects(i, j) = (y_perturbed - y_base) / Delta;
        end
    end
    
    % è®¡ç®—MorrisæŒ‡æ ‡
    mu_star = mean(abs(elementary_effects), 1);  % å¹³å‡ç»å¯¹æ•ˆåº”
    sigma = std(elementary_effects, [], 1);      % æ ‡å‡†å·®ï¼ˆäº¤äº’æ•ˆåº”æŒ‡æ ‡ï¼‰
    
    sensitivity_results = struct(...
        'mu_star', mu_star, ...
        'sigma', sigma, ...
        'elementary_effects', elementary_effects, ...
        'parameter_names', fieldnames(param_bounds) ...
    );
end

% Sobolæ–¹å·®åˆ†è§£
function sobol_results = sobol_sensitivity_analysis(model, param_bounds, N)
    % ç”ŸæˆSobolé‡‡æ ·åºåˆ—
    [A, B, C] = generate_sobol_samples(param_bounds, N);
    
    % è®¡ç®—æ¨¡å‹è¾“å‡º
    Y_A = arrayfun(@(i) run_model_at_point(model, A(i, :)), 1:N);
    Y_B = arrayfun(@(i) run_model_at_point(model, B(i, :)), 1:N);
    Y_C = cell(size(C, 3), 1);
    for i = 1:size(C, 3)
        Y_C{i} = arrayfun(@(j) run_model_at_point(model, C(j, :, i)), 1:N);
    end
    
    % è®¡ç®—SobolæŒ‡æ ‡
    p = size(A, 2);
    S1 = zeros(p, 1);  % ä¸€é˜¶æ•æ„Ÿæ€§æŒ‡æ ‡
    ST = zeros(p, 1);  % æ€»æ•æ„Ÿæ€§æŒ‡æ ‡
    
    V_Y = var([Y_A, Y_B]);  % æ€»æ–¹å·®
    
    for i = 1:p
        % ä¸€é˜¶æ•ˆåº”
        S1(i) = (mean(Y_A .* Y_C{i}) - mean(Y_A) * mean(Y_B)) / V_Y;
        
        % æ€»æ•ˆåº”
        ST(i) = (mean(Y_A .* (Y_A - Y_C{i}))) / V_Y;
    end
    
    sobol_results = struct(...
        'S1', S1, ...           % ä¸€é˜¶æ•æ„Ÿæ€§æŒ‡æ ‡
        'ST', ST, ...           % æ€»æ•æ„Ÿæ€§æŒ‡æ ‡
        'parameter_names', fieldnames(param_bounds) ...
    );
end
```

---

## âœ… éªŒè¯æ–¹æ³•

### 1. å¤šå±‚æ¬¡éªŒè¯æ¡†æ¶

#### 1.1 éªŒè¯å±‚æ¬¡è®¾è®¡

```
å››å±‚éªŒè¯ä½“ç³»ï¼š
Level 1: ç»Ÿè®¡éªŒè¯ (Statistical Validation)
â”œâ”€â”€ RMSE, MAE, MAPE
â”œâ”€â”€ ç›¸å…³ç³»æ•°åˆ†æ
â”œâ”€â”€ RÂ²å†³å®šç³»æ•°
â”œâ”€â”€ Kolmogorov-Smirnovæ£€éªŒ
â””â”€â”€ Anderson-Darlingæ£€éªŒ

Level 2: æ¨¡å¼åŒ¹é…éªŒè¯ (Pattern Matching)
â”œâ”€â”€ å¹‚å¾‹åˆ†å¸ƒæ£€éªŒ
â”œâ”€â”€ èƒ–å°¾åˆ†å¸ƒæµ‹è¯•
â”œâ”€â”€ æ³¢åŠ¨èšé›†åˆ†æ
â”œâ”€â”€ é•¿ç¨‹ä¾èµ–æ£€éªŒ
â””â”€â”€ ç½‘ç»œç‰¹æ€§éªŒè¯

Level 3: è¡Œä¸ºéªŒè¯ (Behavioral Validation)
â”œâ”€â”€ å­¦ä¹ æ›²çº¿éªŒè¯
â”œâ”€â”€ å†³ç­–ä¸€è‡´æ€§æ£€éªŒ
â”œâ”€â”€ é€‚åº”é€Ÿåº¦éªŒè¯
â”œâ”€â”€ é£é™©å“åº”éªŒè¯
â””â”€â”€ ç¤¾ä¼šå½±å“æ¨¡å¼éªŒè¯

Level 4: ç³»ç»ŸéªŒè¯ (System-level Validation)
â”œâ”€â”€ æ¶Œç°æ€§è´¨æ£€æµ‹
â”œâ”€â”€ ç›¸å˜åˆ†æ
â”œâ”€â”€ éŸ§æ€§æµ‹è¯•
â”œâ”€â”€ æ”¿ç­–å“åº”éªŒè¯
â””â”€â”€ è·¨å°ºåº¦äº¤äº’éªŒè¯
```

#### 1.2 éªŒè¯æŒ‡æ ‡æƒé‡

```matlab
validation_weights = struct(...
    'statistical', 0.25, ...      % åŸºç¡€ç»Ÿè®¡æ‹Ÿåˆ
    'pattern_matching', 0.30, ... % é£æ ¼åŒ–äº‹å®éªŒè¯
    'behavioral', 0.25, ...       % å¾®è§‚è¡Œä¸ºéªŒè¯
    'system_level', 0.20 ...      % ç³»ç»Ÿå±‚é¢éªŒè¯
);

% ç»¼åˆéªŒè¯å¾—åˆ†
overall_score = sum(structfun(@(w) w * validation_scores.(w), validation_weights));
```

### 2. å…·ä½“éªŒè¯ç®—æ³•

#### 2.1 ç»Ÿè®¡éªŒè¯

```matlab
function statistical_results = comprehensive_statistical_validation(model_output, empirical_data)
    
    results = struct();
    
    % åŸºç¡€æ‹Ÿåˆåº¦é‡
    results.rmse = sqrt(mean((model_output - empirical_data).^2));
    results.mae = mean(abs(model_output - empirical_data));
    results.mape = mean(abs((model_output - empirical_data) ./ empirical_data)) * 100;
    
    % ç›¸å…³æ€§åˆ†æ
    [correlation_coeff, correlation_p_value] = corrcoef(model_output, empirical_data);
    results.correlation = correlation_coeff(1,2);
    results.correlation_significance = correlation_p_value(1,2);
    
    % å›å½’åˆ†æ
    regression_model = fitlm(empirical_data, model_output);
    results.r_squared = regression_model.Rsquared.Ordinary;
    results.adjusted_r_squared = regression_model.Rsquared.Adjusted;
    
    % åˆ†å¸ƒæ£€éªŒ
    [ks_h, ks_p, ks_statistic] = kstest2(model_output, empirical_data);
    results.ks_test = struct('reject_h0', ks_h, 'p_value', ks_p, 'statistic', ks_statistic);
    
    % Anderson-Darlingæ£€éªŒ
    [ad_h, ad_p, ad_statistic] = adtest(model_output - empirical_data);
    results.ad_test = struct('reject_h0', ad_h, 'p_value', ad_p, 'statistic', ad_statistic);
    
    % ç»¼åˆè¯„åˆ†
    results.overall_score = calculate_statistical_score(results);
    
    return results;
end
```

#### 2.2 æ¨¡å¼åŒ¹é…éªŒè¯

```matlab
function pattern_results = pattern_matching_validation(model_data, reference_patterns)
    
    results = struct();
    
    % å¹‚å¾‹åˆ†å¸ƒæ£€éªŒï¼ˆä¼ä¸šè§„æ¨¡åˆ†å¸ƒï¼‰
    if isfield(model_data, 'enterprise_sizes')
        results.power_law = test_power_law_distribution(model_data.enterprise_sizes, 
                                                       reference_patterns.size_distribution);
    end
    
    % èƒ–å°¾åˆ†å¸ƒæ£€éªŒï¼ˆæ”¶ç›Šç‡åˆ†å¸ƒï¼‰
    if isfield(model_data, 'returns')
        results.fat_tails = test_fat_tail_distribution(model_data.returns, 
                                                      reference_patterns.return_distribution);
    end
    
    % æ³¢åŠ¨ç‡èšé›†æ£€éªŒ
    if isfield(model_data, 'price_volatility')
        results.volatility_clustering = test_volatility_clustering(model_data.price_volatility);
    end
    
    % é•¿ç¨‹ä¾èµ–æ£€éªŒï¼ˆHurstæŒ‡æ•°ï¼‰
    if isfield(model_data, 'time_series')
        results.long_range_dependence = calculate_hurst_exponent(model_data.time_series);
    end
    
    % ç½‘ç»œç‰¹æ€§æ£€éªŒ
    if isfield(model_data, 'network_structure')
        results.network_properties = validate_network_properties(model_data.network_structure, 
                                                                reference_patterns.network_benchmarks);
    end
    
    return results;
end
```

### 3. éªŒè¯æŠ¥å‘Šç”Ÿæˆ

```matlab
function generate_validation_report(validation_results, output_file)
    % ç”ŸæˆHTMLæ ¼å¼çš„éªŒè¯æŠ¥å‘Š
    
    html_content = ['<!DOCTYPE html><html><head><title>æ¨¡å‹éªŒè¯æŠ¥å‘Š</title></head><body>'];
    html_content = [html_content, '<h1>å¤šæ™ºèƒ½ä½“æ°”å€™æ”¿ç­–æ¨¡å‹éªŒè¯æŠ¥å‘Š</h1>'];
    html_content = [html_content, '<h2>éªŒè¯æ¦‚è§ˆ</h2>'];
    
    % æ·»åŠ éªŒè¯æ±‡æ€»è¡¨
    html_content = [html_content, generate_summary_table(validation_results)];
    
    % æ·»åŠ è¯¦ç»†éªŒè¯ç»“æœ
    validation_levels = {'statistical', 'pattern_matching', 'behavioral', 'system_level'};
    for i = 1:length(validation_levels)
        level = validation_levels{i};
        html_content = [html_content, sprintf('<h2>%séªŒè¯ç»“æœ</h2>', level)];
        html_content = [html_content, generate_level_report(validation_results.(level))];
    end
    
    % æ·»åŠ ç»“è®ºå’Œå»ºè®®
    html_content = [html_content, generate_conclusions(validation_results)];
    
    html_content = [html_content, '</body></html>'];
    
    % å†™å…¥æ–‡ä»¶
    fid = fopen(output_file, 'w');
    fprintf(fid, '%s', html_content);
    fclose(fid);
    
    fprintf('éªŒè¯æŠ¥å‘Šå·²ç”Ÿæˆï¼š%s\n', output_file);
end
```

---

**æ€»ç»“**ï¼šæœ¬é™„å½•æä¾›äº†å¤šæ™ºèƒ½ä½“æ°”å€™æ”¿ç­–æ¨¡å‹çš„å®Œæ•´ç†è®ºåŸºç¡€å’ŒæŠ€æœ¯å®ç°ç»†èŠ‚ã€‚æ¨¡å‹é‡‡ç”¨ç®€åŒ–ä½†ç§‘å­¦çš„è®¾è®¡ï¼Œé€šè¿‡å…­ç±»ä¼ä¸šå’ŒåŸºäºè´¨é‡çš„å¸‚åœºæœºåˆ¶ï¼Œå®ç°äº†å¯¹å†œä¸šç³»ç»Ÿä¸­æ°”å€™æ”¿ç­–æ•ˆåº”çš„å‡†ç¡®å»ºæ¨¡ã€‚æ‰€æœ‰å‚æ•°éƒ½åŸºäºä¸­å›½å†œä¸šå®é™…æ•°æ®è¿›è¡Œäº†æ ¡å‡†ï¼Œå¹¶å»ºç«‹äº†å¤šå±‚æ¬¡çš„éªŒè¯æ¡†æ¶ç¡®ä¿æ¨¡å‹çš„å¯é æ€§ã€‚ 